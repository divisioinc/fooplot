{"version":3,"sources":["fooplot.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["FooplotSVGRecorder","width","height","font","textAlign","svgHeader","svgBody","svgFooter","lineWidth","strokeStyle","fillStyle","x","y","path_d","moveToX","moveToY","clear","fillText","_text","_x","_y","_textAnchor","beginPath","moveTo","isNaN","toFixed","lineTo","stroke","fillRect","_w","_h","getSVG","_svg","module","exports","Fooplot","container","options","FOOPLOT_INSTANCES","push","style","overflow","position","webkitUserSelect","MozUserSelect","userSelect","FOOPLOT_MSIE","unselectable","cursor","cover","document","createElement","zIndex","background","filter","opacity","appendChild","subcontainer","recorder","toolcontainer","top","marginTop","marginLeft","padding","webkitBorderRadius","visibility","addToolSeparator","newtool","display","border","marginRight","addToolButton","image","action","modeId","tooltip","className","title","onmousedown","onmouseup","onmouseout","onclick","i","parentNode","_self","selectMode","toolsMode","hideIntersection","intersectionPoint","intersectionDisplay","hideTrace","tracePoint","traceDisplay","selectedMode","FOOPLOT_MODE_MOVE","obj","tool","id","zoomTimeout","zoomSelf","zoomPendingFactor","zoom","factor","window","clearTimeout","FOOPLOT_TRANSITIONS","canvas","OTransition","webkitTransition","MozTransition","msTransition","webkitTransform","MozTransform","msTransform","OTransform","setTimeout","centerx","xmax","xmin","centery","ymax","ymin","reDraw","onWindowChange","toolZoomIn","toolZoomOut","toolMove","toolZoomBox","FOOPLOT_MODE_ZOOMBOX","toolTrace","FOOPLOT_MODE_TRACE","toolIntersection","FOOPLOT_MODE_INTERSECTION","zoomboxBox","left","traceDisplayText","createTextNode","webkitBoxShadow","MozBoxShadow","OBoxShadow","msBoxShadow","boxShadow","intersectionDisplayText","context","vars","plots","plotlastid","xgrid","ygrid","xgridunits","ygridunits","showGrid","showAxes","showTicks","showLabels","gridColor","axesColor","labelsColor","backgroundColor","setSize","offsetWidth","offsetHeight","setAttribute","G_vmlCanvasManager","initElement","error","webkitBackfaceVisibility","getContext","getRealGrid","parseFloat","realxgrid","orderfull","Math","log","order","floor","rem","pow","realygrid","drawGrid","px","py","g","ceil","drawLabels","orderx","ordery","FOOPLOT_UNITS_PI","printy","tryToMakeFraction","pi","FOOPLOT_UNITS_E","e","round","printx","drawAxes","isMouseDown","dragInitX","dragInitY","dpx","dpy","onmousemove","event","preventDefault","srcElement","target","offx","offsetLeft","offy","offsetTop","mx","pageX","body","scrollLeft","clientX","my","pageY","scrollTop","clientY","initx","inity","showTrace","onmouseover","dx","dy","parseInt","newxmin","newymax","newxmax","newymin","showIntersection","lastTouch","ontouchmove","touches","length","_touch","mousemove","ontouchstart","mousedown","ontouchend","mouseup","onmousewheel","returnValue","delta","wheelDelta","detail","addEventListener","drawPoints","points","drawFunction","jeq","thisIsNaN","lastOnScreen","lastIsNaN","thisOnScreen","lastpx","lastpy","lasty","lastychange","isRedoLoop","started","pxstep","min","abs","drawPolar","thetamin","thetamax","thetastep","r","theta","cos","sin","drawParametric","jeqx","jeqy","smin","smax","sstep","s","findIntersection","jeq0","jeq1","xpd","y0","y1","ypd","d","minDistance","besti","besty","FOOPLOT_TYPE_FUNCTION","nodeValue","j","yi","yj","bestPair","plotstmp","slice","unshift","xroot","testnum","numerator","denominator","indexOf","toString","parseEquationError","parseEquationHasElement","v","parseEquationFixPowers","parseEquationIsArray","splice","Array","parseEquationFixFunctions","FOOPLOT_MATH","undefined","parseEquationEror","toLowerCase","constructor","parseEquationJoinArray","t","parseEquation","eq","tokens","pstart","pend","jeq_error","replace","split","match","eval","parseConst","consts","f","alert","type","color","FOOPLOT_TYPE_POLAR","FOOPLOT_TYPE_PARAMETRIC","FOOPLOT_TYPE_POINTS","addPlot","size","deletePlot","plotid","deleteAllPlots","getGrid","setGrid","getWindow","setWindow","w","setBackgroundColor","setLabelsColor","setAxesColor","setGridColor","setShowAxes","setShowTicks","setShowLabels","setShowGrid","tan","asin","acos","atan","exp","sqrt","max","sec","csc","cot","asec","acsc","acot","ln","sinh","cosh","tanh","asinh","acosh","atanh","sech","csch","coth","asech","acsch","acoth","u","navigator","userAgent","b","documentElement","p","charAt","toUpperCase","substr","OVERLAY_ID","OldModule","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","getElementById","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"fooplot.2ec11fd8.js","sourceRoot":"..","sourcesContent":["/********************************************************************\nOnline plotter:   http://fooplot.com/\nPersonal website: http://dheera.net/\n\n--------------------- DO NOT REMOVE THIS NOTICE ---------------------\nFooPlot embeddable plotter v2.0\nCopyright (C) 2012 Dheera Venkatraman <dheera@dheera.net>\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License as\npublished by the Free Software Foundation, either version 3 of the\nLicense, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public\nLicense along with this program.  If not,\nsee <http://www.gnu.org/licenses/>.\n\n---------------------------------------------------------------------\n\nThis code is in BETA; some features are incomplete and the code\ncould be written better. If you are only intending to embed a single\nplot into your webpage, it is suggested to use the 'Get Embed Code'\nfeature on www.fooplot.com to get an IFRAME-based plotter that is\nhotlinked to the latest version of this code.\n\n********************************************************************/\n\nfunction FooplotSVGRecorder() {\n  // drop-in replacement for certain features of the relevant features\n  // of canvas, so that we can record an svg version for generating\n  // other formats\n  this.width=null;\n  this.height=null;\n  this.font='';\n  this.textAlign='';\n  this.svgHeader='';\n  this.svgBody='';\n  this.svgFooter='';\n  this.lineWidth=1;\n  this.strokeStyle='#000000';\n  this.fillStyle='#ffffff';\n  this.x=0;\n  this.y=0;\n  this.path_d='';\n  this.moveToX=null;\n  this.moveToY=null;\n  this.clear=function() {\n    this.svgBody='';\n  }\n  this.fillText=function(_text,_x,_y) {\n    var _textAnchor='start';\n    if(this.textAlign==='center') _textAnchor='middle';\n    if(this.textAlign==='right') _textAnchor='end';\n    this.svgBody+='<text x=\"'+_x+'\" y=\"'+_y+'\" text-anchor=\"'+_textAnchor+'\" style=\"font:'+this.font+';stroke:none;fill:'+this.fillStyle+'\">'+_text+'</text>';\n  }\n  this.beginPath=function() {\n    this.path_d='';\n  }\n  this.moveTo=function(_x,_y) {\n    if(!isNaN(_x) && !isNaN(_y)) {\n      this.moveToX=_x.toFixed(2);\n      this.moveToY=_y.toFixed(2);\n    }\n  }\n  this.lineTo=function(_x,_y) {\n    if(this.moveToX) {\n      this.path_d+='M'+this.moveToX+' '+this.moveToY+' ';\n      this.moveToX=null;\n      this.moveToY=null;\n    }\n    this.path_d+='L'+_x.toFixed(2)+' '+_y.toFixed(2)+' ';\n  }\n  this.stroke=function() {\n    this.svgBody+='<path d=\"'+this.path_d+'\" style=\"fill:none;stroke:'+this.strokeStyle+';stroke-width:'+this.lineWidth+';\" />';\n    this.path_d='';\n  }\n  this.fillRect=function(_x,_y,_w,_h) {\n    this.svgBody+='<rect x=\"'+_x.toFixed(2)+'\" y=\"'+_y.toFixed(2)+'\" width=\"'+_w.toFixed(2)+'\" height=\"'+_h.toFixed(2)+'\" style=\"fill:'+this.fillStyle+';stroke:none;\" />';\n  }\n  this.getSVG=function() {\n    var _svg='';\n    _svg+='<?xml version=\"1.0\" standalone=\"no\"?>';\n    _svg+='<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">';\n    _svg+='<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 '+this.width+' '+this.height+'\" version=\"1.1\">';\n    _svg+='<clipPath id=\"box\"><rect x=\"0\" y=\"0\" width=\"'+this.width+'\" height=\"'+this.height+'\" style=\"fill:none;stroke:none;\" /></clipPath>';\n    _svg+='<g clip-path=\"url(#box)\">';\n    _svg+=this.svgBody;\n    _svg+='</g></svg>';\n    return _svg;\n  }\n}\n\nmodule.exports = function Fooplot(container,options) {\n\n  // PRIVATE: INITIALISATION AND BASIC FUNCTIONS\n\n  FOOPLOT_INSTANCES.push(this);\n\n  this.container=container;\n  this.container.style.overflow='hidden';\n  this.container.style.position='relative';\n  this.container.style.webkitUserSelect='none';\n  this.container.style.MozUserSelect='none';\n  this.container.style.userSelect='none';\n  if(FOOPLOT_MSIE) this.container.unselectable=true;\n  this.container.style.cursor='move';\n\n  this.cover=document.createElement('div');\n  this.cover.style.position='absolute';\n  this.cover.style.width='100%';\n  this.cover.style.height='100%';\n  this.container.style.webkitUserSelect='none';\n  this.container.style.MozUserSelect='none';\n  if(FOOPLOT_MSIE) this.cover.unselectable=true;\n  this.cover.style.zIndex=100;\n  this.cover.style.background='#ffffff';\n  this.cover.style.filter='alpha(opacity=0)';\n  this.cover.style.opacity=0;\n  this.container.appendChild(this.cover);\n\n  this.subcontainer=document.createElement('div');\n  this.subcontainer.style.position='absolute';\n  this.subcontainer.style.zIndex='1';\n  this.subcontainer.style.webkitUserSelect='none';\n  this.subcontainer.style.userSelect='none';\n  if(FOOPLOT_MSIE) this.subcontainer.unselectable=true;\n  this.container.appendChild(this.subcontainer);\n\n  this.recorder=new FooplotSVGRecorder();\n\n  this.toolcontainer=document.createElement('div');\n  this.toolcontainer.style.position='absolute';\n  this.toolcontainer.style.top='100%';\n  this.toolcontainer.style.zIndex='200';\n  this.toolcontainer.style.opacity=0.7;\n  this.toolcontainer.style.marginTop='-60px';\n  this.toolcontainer.style.marginLeft='10px';\n  this.toolcontainer.style.padding='10px';\n  this.toolcontainer.style.height='32px';\n  this.toolcontainer.style.webkitBorderRadius='5px';\n  this.toolcontainer.style.visibility='hidden';\n  this.container.appendChild(this.toolcontainer);\n\n\n  this.addToolSeparator=function() {\n    var newtool=document.createElement('div');\n    newtool.style.display='inline';\n    newtool.style.width='32px';\n    newtool.style.height='1px';\n    newtool.style.border='0px';\n    newtool.style.padding='0px';\n    newtool.style.marginRight='15px';\n    this.toolcontainer.appendChild(newtool);\n  }\n\n  this.addToolButton=function(image,action,modeId,tooltip) {\n    var newtool=document.createElement('button');\n    newtool.className='fooplot-tool';\n    newtool.style.width='32px';\n    if(tooltip) newtool.title=tooltip;\n    newtool.style.background=image;\n    newtool.style.position='relative';\n    newtool.style.height='32px';\n    newtool.style.border='0px';\n    newtool.style.padding='0px';\n    newtool.style.marginRight='15px';\n    newtool.style.cursor='pointer';\n    if(!modeId) {\n      newtool.onmousedown=function() {this.style.opacity=0.7;this.style.filter='alpha(opacity=70)';}\n      newtool.onmouseup=function() {this.style.opacity=1;this.style.filter='';}\n      newtool.onmouseout=function() {this.style.opacity=1;this.style.filter='';}\n      newtool.onclick=action;\n    } else {\n      newtool.onclick=function() {\n        for (i in FOOPLOT_INSTANCES) if(this.parentNode===FOOPLOT_INSTANCES[i].toolcontainer) var _self=FOOPLOT_INSTANCES[i];\n        _self.selectMode(this);\n      }\n      this.toolsMode.push({'tool':newtool,'id':modeId});\n    }\n    this.toolcontainer.appendChild(newtool);\n    return newtool;\n  }\n\n  this.hideIntersection=function() {\n    this.intersectionPoint.style.visibility='hidden';\n    this.intersectionDisplay.style.visibility='hidden';\n  }\n\n  this.hideTrace=function() {\n    this.tracePoint.style.visibility='hidden';\n    this.traceDisplay.style.visibility='hidden';\n  }\n\n  this.toolsMode=[];\n  this.selectedMode=FOOPLOT_MODE_MOVE;\n  this.selectMode=function(obj) {\n    this.hideIntersection();\n    this.hideTrace();\n    for (i in this.toolsMode) {\n      if(this.toolsMode[i].tool===obj || this.toolsMode[i].id===obj) {\n        this.selectedMode=this.toolsMode[i].id;\n        this.toolsMode[i].tool.style.opacity=0.7;\n        this.toolsMode[i].tool.style.filter='alpha(opacity=70)';\n      } else {\n        this.toolsMode[i].tool.style.opacity=1;\n        this.toolsMode[i].tool.style.filter='';\n      }\n    }\n  }\n\n  this.zoomTimeout=null;\n  this.zoomSelf=null;\n  this.zoomPendingFactor=1;\n\n  this.zoom=function(factor) {\n    if(this.zoomTimeout) window.clearTimeout(this.zoomTimeout);\n    if(FOOPLOT_TRANSITIONS && this.canvas && this.canvas.style && factor!=1) {\n        this.canvas.style.OTransition='-o-transform 0.4s ease';\n        this.canvas.style.webkitTransition='-webkit-transform 0.4s ease';\n        this.canvas.style.MozTransition='-moz-transform 0.4s ease';\n        this.canvas.style.msTransition='-webkit-transform 0.4s ease';\n        this.canvas.style.webkitTransform+='scale('+factor+')';\n        this.canvas.style.MozTransform+='scale('+factor+')';\n        this.canvas.style.msTransform+='scale('+factor+')';\n        this.canvas.style.OTransform+='scale('+factor+')';\n      }\n      this.hideIntersection();\n      this.hideTrace();\n      this.zoomSelf=this;\n      this.zoomPendingFactor*=factor;\n      this.zoomTimeout=window.setTimeout(function(_self) {\n        if(!_self) for (i in FOOPLOT_INSTANCES) if(FOOPLOT_INSTANCES[i].zoomSelf) var _self=FOOPLOT_INSTANCES[i].zoomSelf;\n        var centerx=(_self.xmax+_self.xmin)/2;\n        var centery=(_self.ymax+_self.ymin)/2;\n        _self.xmax=(_self.xmax-centerx)/_self.zoomPendingFactor+centerx;\n        _self.xmin=(_self.xmin-centerx)/_self.zoomPendingFactor+centerx;\n        _self.ymax=(_self.ymax-centery)/_self.zoomPendingFactor+centery;\n        _self.ymin=(_self.ymin-centery)/_self.zoomPendingFactor+centery;\n        _self.zoomPendingFactor=1;\n        _self.reDraw();\n        _self.canvas.style.OTransition='color 0 ease'; // opera hack\n        _self.canvas.style.webkitTransition='';\n        _self.canvas.style.MozTransition='';\n        _self.canvas.style.msTransition='';\n        _self.canvas.style.webkitTransform='';\n        _self.canvas.style.MozTransform='';\n        _self.canvas.style.msTransform+='';\n        _self.canvas.style.OTransform='';\n        _self.onWindowChange([_self.xmin,_self.xmax,_self.ymin,_self.ymax]);\n        _self.zoomTimeout=null;\n        _self.zoomSelf=null;\n      },FOOPLOT_TRANSITIONS?450:0,this);\n  }\n\n  this.toolZoomIn=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAPZRAP9/AP+AAP+AAf+AAv+BA/+BBP+DB/+GDf+GDv+HD/+KFv+LGP+MGv+OHf+PH/+QIv+UKf+UKv+YMv+aNv+bN/+gQf+iRf+jSP+kSf+nUP+oUv+pU/+pVP+qVv+sWf+wYf+xY/+2bv+5c/+8ev+9fP+/gP/Bg//Chv/Eiv/Gjf/HkP/Jk//Ll//Mmf/Onv/Qof/Ysv/bt//cuf/cuv/du//evf/evv/gwf/gwv/hw//jx//kyv/mzf/nz//s2v/v3//v4P/w4f/w4v/x4//y5v/06v/27f/48f/59P/69v/79//7+P/8+f/8+v/9+//+/f/+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAFIALAAAAAAgACAAAAf+gFJSAAEAhoeIiYqJglKFi5CRhwGDkpaSj5eak5oGDJuaFio6SFFGMycQoIoJLlGvsK9IIpmgFECxua85CqsJQ7lAP0S5MKsvuUuGFLofmxi6ygDMuUe9ly3Ry7pRHpo8uk3buimXBk2vNQnrCYYG7AmlUTmXD7AytYpLr0OXAfIyDAg0YCjAQAPyYmjKoW0atxOaVDSklguDJgnoYkmjCAtIO00lko2LVQGUAXCxePTwoUvDqgY1uIVzCSpACHm5hoyQ16TDKgAOQLDYUaQGig7tMOyL0oTmT0hKX/V8GgkDT1VUF0UtkbUqCUX5uiIKKxaRo7KJKAkihLaQoEAAOw==\\')',\n    function() {\n      for (i in FOOPLOT_INSTANCES) if(this.parentNode===FOOPLOT_INSTANCES[i].toolcontainer) var _self=FOOPLOT_INSTANCES[i];\n      _self.zoom(2);\n    },\n    null,\n    'Zoom In'\n  );\n\n  this.toolZoomOut=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAPZLAP9/AP+AAP+AAf+AAv+BBP+DB/+GDf+GDv+HD/+KFv+LF/+LGP+MGv+OHf+PH/+QIv+UKf+UKv+YMv+bN/+gQf+iRf+jSP+kSf+nUP+oUv+pU/+pVP+qVv+rWP+sWf+wYf+xY/+zZ/+2bv+5c/+8ev+9fP+/gP/Bg//Chv/Eiv/Gjf/HkP/Jk//Ll//Mmf/Onv/Qof/Ysv/bt//cuv/evf/evv/gwf/gwv/hw//jx//kyv/mzf/v4P/w4f/w4v/x4//06v/27f/48f/59P/69v/79//7+P/8+v/9+//+/f/+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAEwALAAAAAAgACAAAAfXgExMAAEAhoeIiYqJgkyFi5CRhwGDkpaSj5eak5oFDJuaFSw5Q0tBMygQoIoIL0uvsK9DI5mgEzyxua84CqsIP7rBMaswwcYfmxfGxkILmi7Lxh2aO9HBKpcFR7khCt7exbE2lw+604gtuT+XAaWx54fpsTKaOda6KJoq97kXmhL8YPFAsKlEwCUUQBWoxi/DqgY1+B1xCCqACHfqSLg7wmEVgAcfWugAUiMFB4IXjLya6FFSypUdW0K6sFGVzEUvTdyMdKHEzlW1fipyJDQRJUFFDRUSFAgAOw==\\')',\n    function() {\n      for (i in FOOPLOT_INSTANCES) if(this.parentNode===FOOPLOT_INSTANCES[i].toolcontainer) var _self=FOOPLOT_INSTANCES[i];\n      _self.zoom(0.5);\n    },\n    null,\n    'Zoom Out'\n  );\n\n  this.addToolSeparator();\n\n  this.toolMove=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAPY/AP9/AP+AAP+AAf+AAv+BBP+CBf+FDP+GDv+HD/+IEf+IEv+JE/+KFv+MGv+NG/+OHf+PH/+PIP+QIf+QIv+TKP+UKf+bOP+dPP+fQP+jSP+oUv+pVP+rWP+uXf+xY/+1a/+3cP+6dv+7d/+7eP+8ef+9e/++ff/Dh//DiP/Hj//Ikv/Klf/Ll//LmP/NnP/Pn//du//fv//hw//ixv/kyv/lzP/mzv/o0f/o0v/p1P/t2//u3v/v4P/w4f/+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAEAALAAAAAAgACAAAAf0gEBAAAEAhoeIiYqHhYJAhYuRkoyDk4mQloaYlhw5D5mEoAAjPz87E6KWBC6lpaepkQgwra09qLCJDhYWIKUiGhsXuJEZpRbDk8U/x8jExs0TwonKzIgUm4sRPBuK1IogLJMPOz8a3c+JvSiRDjq+u/C8pR7xuymlJIoBOLT9/v+lPijqALDgPxmLTPjKwLAhqR8gGjZsUYoGgkisMJxb9u2HjQWRAhCAoXEaOkQgcICchCDCxmqHMjBo5q3Zopo2TXLMaSgDCHClWIwYUSEngxv+VGAbpsAGrXU8DSGYgU/U0kUIYoCIqg/WI66UBIXi2QhIIAA7\\')',\n    null,FOOPLOT_MODE_MOVE,'Move');\n\n  this.toolZoomBox=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAPYAAP9/AP+AAP+AAf+AAv+BA/+BBP+CBf+DB/+GDf+GDv+HD/+KFv+LGP+MGv+OHf+PH/+QIv+TJ/+UKf+UKv+YMv+bN/+gQf+iRf+jSP+kSf+nT/+nUP+oUv+pU/+pVP+qVv+sWf+uXv+wYf+xY/+1a/+2bv+3b/+5c/+8ev+9fP+/gP/Bg//Chv/Eiv/Gjf/Hj//HkP/Jk//JlP/Ll//Mmf/Onv/Qof/Xr//Ysv/bt//cuv/evf/evv/gwf/gwv/hw//jx//kyv/mzf/r1//v4P/w4f/w4v/x4//06v/27f/48f/59P/69v/79//7+P/8+v/9+//9/P/+/f/+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAFUALAAAAAAgACAAAAf+gFVVAAEAhoeIiYqHhYJVhYuRkoyDk5aTkJeajJoHDZuaFzFAS1RJOiwSoIoKNVSvsK9LJ5mgFUSxua8/C6sKR09LT03CS07Gx1Q4qzZUGoaQAdKHL1Qimxmvz4qZ1Uq9lzTahgfl5geG1VQfmkLjADe5JumvL5cHT+/xsfMA6j+XIMDatg9WP3VELgUo5cxQwVcHX+nQ5OPdjCEYMYagR2WFJnXbJIHUROGdSCpEFGxKQYVEhJcwY0ZoZgHUAXe6cnJY5WBHTl1Pdq4ywTAXERQMg64C8GDEjCBIdrT4oDKDk1dP2C2VZBWr0K2Lur5SBXYRhqsqykrCkELtqloObhU9ipsogCO60AAICgQAOw==\\')',\n    null,FOOPLOT_MODE_ZOOMBOX,'Zoom Box');\n\n  this.toolTrace=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAMYAAP9/AP+AAP+AAf+AAv+BBP+CBf+FDP+GDv+HD/+IEf+IEv+JE/+KFv+MGv+NG/+OHf+PH/+PIP+QIf+QIv+TKP+UKf+bOP+dPP+fQP+jSP+oUv+pVP+rWP+uXf+xY/+1a/+3cP+6dv+7d/+7eP+8ef+9e/++ff/Dh//DiP/Hj//Ikv/Klf/Ll//LmP/NnP/Pn//du//fv//hw//ixv/kyv/lzP/mzv/o0f/o0v/p1P/t2//u3v/v4P/w4f/+/v////9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/ACH5BAEAAD4ALAAAAAAgACAAAAdfgD4+AAEAhoeIiYqHhYI+hYuRkoyDk5aTkJeajJudnp+goaKjpKWmp6iJP6urqD+qr6SxirOgtbSsnre4rZu7vL+jrL2ph8GmxMUAw8rNzs/Q0YqZ0qePxQGOhKaNPoEAOw==\\')',\n    null,FOOPLOT_MODE_TRACE,'Trace');\n\n  this.toolIntersection=this.addToolButton(\n    'url(\\'data:image/gif;base64,R0lGODlhIAAgAMYAAP9/AP+AAP+AAf+AAv+BBP+CBf+FDP+GDv+HD/+IEf+IEv+JE/+KFv+MGv+NG/+OHf+PH/+PIP+QIf+QIv+TKP+UKf+bOP+dPP+fQP+jSP+oUv+pVP+rWP+uXf+xY/+1a/+3cP+6dv+7d/+7eP+8ef+9e/++ff/Dh//DiP/Hj//Ikv/Klf/Ll//LmP/NnP/Pn//du//fv//hw//ixv/kyv/lzP/mzv/o0f/o0v/p1P/t2//u3v/v4P/w4f/+/v////9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/AP9/ACH5BAEAAD4ALAAAAAAgACAAAAdygD4+AAEAhoeIiYqHhYI+hYuRkoyDk5aTkJeajJuRP52gn6CaP6Kjlqank6mqi6ytiq+opaWeo6yyspK5ibq7trS+tp7BsLHFxojBwqe0yb2HzJ24z7ywvrXNl9mb0tHe3rfP44uZ5OeLj+gBjoTPjT6BADs=\\')',\n    null,FOOPLOT_MODE_INTERSECTION,'Find Intersections and Roots');\n\n\n  this.zoomboxBox=document.createElement('div');\n  this.zoomboxBox.style.position='absolute';\n  this.zoomboxBox.style.visibility='hidden';\n  this.zoomboxBox.style.width='1px';\n  this.zoomboxBox.style.height='1px';\n  this.zoomboxBox.style.top='-1px';\n  this.zoomboxBox.style.left='-1px';\n  this.zoomboxBox.style.border='1px solid #ff8000';\n  this.zoomboxBox.style.background='#ffa000';\n  this.zoomboxBox.style.opacity=0.5;\n  this.zoomboxBox.style.filter='alpha(opacity=50)';\n  this.zoomboxBox.style.zIndex=50;\n  this.container.appendChild(this.zoomboxBox);\n\n  this.tracePoint=document.createElement('div');\n  this.tracePoint.style.position='absolute';\n  this.tracePoint.style.visibility='hidden';\n  this.tracePoint.style.width='5px';\n  this.tracePoint.style.height='5px';\n  this.tracePoint.style.top='-1px';\n  this.tracePoint.style.left='-1px';\n  this.tracePoint.style.border='1px solid #ffffff';\n  this.tracePoint.style.background='#ff8000';\n  this.tracePoint.style.zIndex=50;\n  this.container.appendChild(this.tracePoint);\n\n  this.traceDisplay=document.createElement('div');\n  this.traceDisplayText=document.createTextNode('');\n  this.traceDisplay.style.position='absolute';\n  this.traceDisplay.style.visibility='hidden';\n  this.traceDisplay.style.height='20px';\n  this.traceDisplay.style.padding='4px';\n  this.traceDisplay.style.top='-1px';\n  this.traceDisplay.style.left='-1px';\n  this.traceDisplay.style.border='1px solid #a0a0a0';\n  this.traceDisplay.style.background='#ffffff';\n  this.traceDisplay.style.webkitBoxShadow='5px 5px 5px #808080';\n  this.traceDisplay.style.MozBoxShadow='5px 5px 5px #808080';\n  this.traceDisplay.style.OBoxShadow='5px 5px 5px #808080';\n  this.traceDisplay.style.msBoxShadow='5px 5px 5px #808080';\n  this.traceDisplay.style.boxShadow='5px 5px 5px #808080';\n  this.traceDisplay.style.zIndex=50;\n  this.traceDisplay.appendChild(this.traceDisplayText);\n  this.container.appendChild(this.traceDisplay);\n\n\n  this.intersectionPoint=document.createElement('div');\n  this.intersectionPoint.style.position='absolute';\n  this.intersectionPoint.style.visibility='hidden';\n  this.intersectionPoint.style.width='5px';\n  this.intersectionPoint.style.height='5px';\n  this.intersectionPoint.style.top='-1px';\n  this.intersectionPoint.style.left='-1px';\n  this.intersectionPoint.style.border='1px solid #ffffff';\n  this.intersectionPoint.style.background='#ff8000';\n  this.intersectionPoint.style.zIndex=50;\n  this.container.appendChild(this.intersectionPoint);\n\n  this.intersectionDisplay=document.createElement('div');\n  this.intersectionDisplayText=document.createTextNode('');\n  this.intersectionDisplay.style.position='absolute';\n  this.intersectionDisplay.style.visibility='hidden';\n  this.intersectionDisplay.style.height='20px';\n  this.intersectionDisplay.style.padding='4px';\n  this.intersectionDisplay.style.top='-1px';\n  this.intersectionDisplay.style.left='-1px';\n  this.intersectionDisplay.style.border='1px solid #a0a0a0';\n  this.intersectionDisplay.style.background='#ffffff';\n  this.intersectionDisplay.style.webkitBoxShadow='5px 5px 5px #808080';\n  this.intersectionDisplay.style.MozBoxShadow='5px 5px 5px #808080';\n  this.intersectionDisplay.style.OBoxShadow='5px 5px 5px #808080';\n  this.intersectionDisplay.style.msBoxShadow='5px 5px 5px #808080';\n  this.intersectionDisplay.style.boxShadow='5px 5px 5px #808080';\n  this.intersectionDisplay.style.zIndex=50;\n  this.intersectionDisplay.appendChild(this.intersectionDisplayText);\n  this.container.appendChild(this.intersectionDisplay);\n\n  this.selectMode(FOOPLOT_MODE_MOVE);\n\n  this.canvas=false;\n  this.context=false;\n  this.vars={'pi':3.14159265358979323,'e':2.718281828459045,'s':0,'t':0,'x':0,'theta':0};\n  this.plots=[];\n  this.plotlastid=0;\n  this.width=false;\n  this.height=false;\n\n  // window options\n  this.xmin=-6.5;\n  this.xmax=6.5;\n  this.ymin=-4;\n  this.ymax=4;\n  this.xgrid=''; // blank means auto\n  this.ygrid=''; // blank means auto\n  this.xgridunits=null;\n  this.ygridunits=null;\n\n  this.showGrid=true;\n  this.showAxes=true;\n  this.showTicks=true;\n  this.showLabels=true;\n\n  this.gridColor='#D0D0D0';\n  this.axesColor='#606060';\n  this.labelsColor='#606060';\n  this.backgroundColor='#FFFFFF';\n\n  this.setSize=function() {\n    this.width=this.container.offsetWidth;\n    this.height=this.container.offsetHeight;\n    this.canvas.setAttribute('width',this.width);\n    this.canvas.setAttribute('height',this.height);\n    this.recorder.width=this.width;\n    this.recorder.height=this.height;\n  }\n\n  this.canvas=document.createElement('canvas');\n  try { if(FOOPLOT_MSIE) {\n    G_vmlCanvasManager.initElement(this.canvas);\n  } } catch(error) { }\n  this.subcontainer.appendChild(this.canvas);\n  this.setSize();\n  this.canvas.style.webkitBackfaceVisibility='hidden';\n  this.canvas.style.webkitTransform='translate3d(0,0,0)';\n  this.canvas.style.MozTransform='translate3d(0,0,0)';\n  this.context=this.canvas.getContext(\"2d\");\n\n  this.getRealGrid=function() {\n    if(parseFloat(this.xgrid)) {\n      realxgrid=this.xgrid;\n    } else {\n      orderfull=-0.9+Math.log(this.xmax-this.xmin)/Math.log(10);\n      order=Math.floor(orderfull);\n      rem=orderfull-order;\n      realxgrid=Math.pow(10,order);\n      if(rem>.7) realxgrid*=5;\n      else if(rem>.3) realxgrid*=2;\n    }\n    if(parseFloat(this.ygrid)) {\n      realygrid=this.ygrid;\n    } else {\n      orderfull=-0.9+Math.log(this.width/this.height*(this.ymax-this.ymin))/Math.log(10);\n      order=Math.floor(orderfull);\n      rem=orderfull-order;\n      realygrid=Math.pow(10,order);\n      if(rem>.7) realygrid*=5;\n      else if(rem>.3) realygrid*=2;\n    }\n    return [realxgrid,realygrid];\n  }\n\n  this.drawGrid=function() {\n    var px,py,x,y,realxgrid,realygrid,order,orderfull,g;\n    g=this.getRealGrid();\n    realxgrid=g[0];\n    realygrid=g[1];\n    if((this.ymax-this.ymin)/realygrid>this.height/2 || (this.xmax-this.xmin)/realxgrid>this.width/2) {\n      this.context.fillRect(0,0,this.width,this.height);\n    } else {\n      this.context.beginPath();\n      for(y=Math.ceil(this.ymin/realygrid)*realygrid;y<=this.ymax;y+=realygrid) {\n        py=(1-(y-this.ymin)/(this.ymax-this.ymin))*this.height;\n        this.context.moveTo(0,Math.floor(py));\n        this.context.lineTo(this.width,Math.floor(py));\n      }\n      for(x=Math.ceil(this.xmin/realxgrid)*realxgrid;x<=this.xmax;x+=realxgrid) {\n        px=(x-this.xmin)/(this.xmax-this.xmin)*this.width;\n        this.context.moveTo(Math.floor(px),0);\n        this.context.lineTo(Math.floor(px),this.height);\n      }\n      this.context.stroke();\n    }\n  }\n\n  this.drawLabels=function() {\n    var px,py,x,y,realxgrid,realygrid;\n    g=this.getRealGrid();\n    realxgrid=g[0];\n    realygrid=g[1];\n    var orderx=Math.pow(10,2-Math.floor(Math.log(this.xmax-this.xmin)/Math.log(10)));\n    var ordery=Math.pow(10,2-Math.floor(Math.log(this.ymax-this.ymin)/Math.log(10)));\n    this.context.font='10px Droid Sans,Trebuchet MS,Arial,Helvetica,sans-serif';\n    px=(0-this.xmin)/(this.xmax-this.xmin)*this.width;\n    this.context.textAlign='left';\n    if(px<0) px=0;\n    if(px>this.width-this.width/80-16) {\n      if(this.xmax>0) px-=20;\n      else px=this.width-this.width/100-18;\n      this.context.textAlign='right';\n    }\n    if((this.ymax-this.ymin)/realygrid<this.height/6) {\n      for(y=Math.floor(this.ymin/realygrid)*realygrid;y<=this.ymax;y+=realygrid) {\n        py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n        if(this.ygridunits===FOOPLOT_UNITS_PI) {\n          printy=this.tryToMakeFraction(y/this.vars.pi)+'π';\n        } else if(this.ygridunits===FOOPLOT_UNITS_E) {\n          printy=this.tryToMakeFraction(y/this.vars.e)+'e';\n        } else {\n          printy=parseFloat(Math.round(y*ordery)/ordery);\n        }\n        if(py>8 && py<this.height-8) this.context.fillText(printy,px+this.width/80,py+2.5);\n      }\n    }\n    this.context.textAlign='center';\n    py=(this.ymax)/(this.ymax-this.ymin)*this.height;\n    if(py<0) py=0;\n    if(py>this.height-16-this.width/80) {\n      if(this.ymin<0) py-=22;\n      else py=this.height-20-this.width/100;\n    }\n    if((this.xmax-this.xmin)/realxgrid<this.width/6) {\n      for(x=Math.floor(this.xmin/realxgrid)*realxgrid;x<=this.xmax;x+=realxgrid) {\n        px=(x-this.xmin)/(this.xmax-this.xmin)*this.width;\n        if(this.xgridunits===FOOPLOT_UNITS_PI) {\n          printx=this.tryToMakeFraction(x/this.vars.pi)+'π';\n        } else if(this.xgridunits===FOOPLOT_UNITS_E) {\n          printx=this.tryToMakeFraction(x/this.vars.e)+'e';\n        } else {\n          printx=parseFloat(Math.round(x*orderx)/orderx);\n        }\n        if(px>8 && px<this.width-8) this.context.fillText(printx,px,py+this.width/80+8);\n      }\n    }\n  }\n  this.drawAxes=function() {\n    var px,py,x,y,realxgrid,realygrid;\n    g=this.getRealGrid();\n    realxgrid=g[0];\n    realygrid=g[1];\n    if(this.xmin<0 && this.xmax>0) {\n      px=(0-this.xmin)/(this.xmax-this.xmin)*this.width;\n    } else if(this.xmin>=0) {\n      px=0;\n    } else if(this.xmax<=0) {\n      px=this.width;\n    }\n    this.context.beginPath();\n    this.context.moveTo(px,0);\n    this.context.lineTo(px,this.height);\n    this.context.stroke();\n    if(this.showTicks) {\n      if((this.ymax-this.ymin)/realygrid>this.height/2) {\n        this.context.fillRect(px-this.width/100,0,this.width/50,this.height);\n      } else {\n        this.context.beginPath();\n        for(y=Math.floor(this.ymin/realygrid)*realygrid;y<=this.ymax;y+=realygrid) {\n          py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n          this.context.moveTo(px-this.width/100,py);\n          this.context.lineTo(px+this.width/100,py);\n        }\n        this.context.stroke();\n      }\n    }\n    if(this.ymin<0 && this.ymax>0) {\n      py=(1-(0-this.ymin)/(this.ymax-this.ymin))*this.height;\n    } else if(this.ymin>=0) {\n      py=this.height;\n    } else if(this.ymax<=0) {\n      py=0;\n    }\n    this.context.beginPath();\n    this.context.moveTo(0,py);\n    this.context.lineTo(this.width,py);\n    this.context.stroke();\n    if(this.showTicks) {\n      if((this.xmax-this.xmin)/realxgrid>this.width/2) {\n        this.context.fillRect(0,py-this.width/100,this.width,this.width/50);\n      } else {\n        this.context.beginPath();\n        for(x=Math.floor(this.xmin/realxgrid)*realxgrid;x<=this.xmax;x+=realxgrid) {\n          px=(x-this.xmin)/(this.xmax-this.xmin)*this.width;\n          this.context.moveTo(px,py-this.width/100);\n          this.context.lineTo(px,py+this.width/100);\n        }\n        this.context.stroke();\n      }\n    }\n  }\n\n  this.clear=function() {\n    if(this.context!=this.recorder) {\n      this.canvas.width=this.canvas.width;\n    }\n    if(this.context.clear) {\n      this.context.clear();\n    }\n    this.context.fillStyle=this.backgroundColor;\n    this.context.fillRect(0,0,this.width,this.height);\n  }\n\n  // PRIVATE: EVENT HANDLERS\n\n  this.isMouseDown=0;\n  this.dragInitX=0;\n  this.dragInitY=0;\n  this.dpx=0;\n  this.dpy=0;\n\n  this.container.onmousemove=function(e) {\n    if(e === null) e = window.event;\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e && e.preventDefault) e.preventDefault();\n    if(e && (e.srcElement?e.srcElement:e.target).className==='fooplot-tool') return null;\n    if(_self.zoomTimeout) return null;\n    var offx=_self.container.offsetLeft;\n    var offy=_self.container.offsetTop;\n    if(_self.container.parentNode) {\n      offx+=_self.container.parentNode.offsetLeft;\n      offy+=_self.container.parentNode.offsetTop;\n    }\n    var mx=(!FOOPLOT_MSIE?e.pageX:(document.body.scrollLeft+event.clientX))-offx;\n    var my=(!FOOPLOT_MSIE?e.pageY:(document.body.scrollTop+event.clientY))-offy;\n    if(_self.isMouseDown) {\n      _self.dpx=mx-_self.dragInitX;\n      _self.dpy=my-_self.dragInitY;\n      switch(_self.selectedMode) {\n        case FOOPLOT_MODE_MOVE:\n        _self.subcontainer.style.left=_self.dpx+'px';\n        _self.subcontainer.style.top=_self.dpy+'px';\n        break;\n        case FOOPLOT_MODE_ZOOMBOX:\n        _self.zoomboxBox.style.width=(_self.dpx)+'px';\n        _self.zoomboxBox.style.height=(_self.dpy)+'px';\n        break;\n        case FOOPLOT_MODE_TRACE:\n        var initx=mx/_self.width*(_self.xmax-_self.xmin)+_self.xmin;\n        var order=Math.pow(10,2-Math.floor(Math.log(_self.xmax-_self.xmin)/Math.log(10)));\n        var initx=parseFloat(Math.floor(initx*order)/order);\n        var inity=(1-my/_self.height)*(_self.ymax-_self.ymin)+_self.ymin;\n        _self.showTrace(initx,inity);\n        break;\n      }\n    }\n  }\n\n  this.container.onmouseover=function(e) {\n    if(e === null) e = window.event;\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e && e.preventDefault) e.preventDefault();\n    _self.toolcontainer.style.visibility='visible';\n    if(e && (e.srcElement?e.srcElement:e.target).className==='fooplot-tool') return null;\n  }\n\n  this.container.onmouseout=function(e) {\n    if(e === null) e = window.event;\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e && e.preventDefault) e.preventDefault();\n    _self.toolcontainer.style.visibility='hidden';\n    if(e && (e.srcElement?e.srcElement:e.target).className=='fooplot-tool') return null;\n    this.onmouseup(e);\n  }\n\n  this.container.onmousedown=function(e) {\n    if(e === null) e = window.event;\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e && e.preventDefault) e.preventDefault();\n    if(e && (e.srcElement?e.srcElement:e.target).className=='fooplot-tool') return null;\n    if(_self.zoomTimeout) return null;\n    var offx=_self.container.offsetLeft;\n    var offy=_self.container.offsetTop;\n    if(_self.container.parentNode) {\n      offx+=_self.container.parentNode.offsetLeft;\n      offy+=_self.container.parentNode.offsetTop;\n    }\n    var mx=(!FOOPLOT_MSIE?e.pageX:(document.body.scrollLeft+event.clientX))-offx;\n    var my=(!FOOPLOT_MSIE?e.pageY:(document.body.scrollTop+event.clientY))-offy;\n    _self.dragInitX=mx;\n    _self.dragInitY=my;\n    _self.isMouseDown=true;\n    switch(_self.selectedMode) {\n      case FOOPLOT_MODE_ZOOMBOX:\n      _self.zoomboxBox.style.left=mx+'px';\n      _self.zoomboxBox.style.top=my+'px';\n      _self.zoomboxBox.style.width='0px';\n      _self.zoomboxBox.style.height='0px';\n      _self.zoomboxBox.style.visibility='visible';\n      break;\n    }\n  }\n\n  this.container.onmouseup=function(e) {\n    if(e === null) e = window.event;\n    if(e && e.preventDefault) e.preventDefault();\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    var offx=_self.container.offsetLeft;\n    var offy=_self.container.offsetTop;\n    if(_self.container.parentNode) {\n      offx+=_self.container.parentNode.offsetLeft;\n      offy+=_self.container.parentNode.offsetTop;\n    }\n    var mx=(!FOOPLOT_MSIE?e.pageX:(document.body.scrollLeft+event.clientX))-offx;\n    var my=(!FOOPLOT_MSIE?e.pageY:(document.body.scrollTop+event.clientY))-offy;\n    if(_self.isMouseDown) {\n      _self.isMouseDown=false;\n      switch(_self.selectedMode) {\n        case FOOPLOT_MODE_MOVE:\n        if(_self.zoomTimeout) return null;\n        var dx=_self.dpx/_self.width*(_self.xmax-_self.xmin);\n        var dy=_self.dpy/_self.height*(_self.ymax-_self.ymin);\n        _self.xmin-=dx;\n        _self.xmax-=dx;\n        _self.ymin+=dy;\n        _self.ymax+=dy;\n        _self.dpx=0;\n        _self.dpy=0;\n        _self.subcontainer.style.left='0px';\n        _self.subcontainer.style.top='0px';\n        _self.reDraw();\n        _self.onWindowChange([_self.xmin,_self.xmax,_self.ymin,_self.ymax]);\n        break;\n        case FOOPLOT_MODE_ZOOMBOX:\n        _self.zoomboxBox.style.visibility='hidden';\n        _self.selectMode(FOOPLOT_MODE_MOVE);\n        if(parseInt(_self.zoomboxBox.style.width)>5 && parseInt(_self.zoomboxBox.style.height)>5) {\n          var newxmin=(parseInt(_self.zoomboxBox.style.left)/_self.width)*(_self.xmax-_self.xmin)+_self.xmin;\n          var newymax=_self.ymax-(parseInt(_self.zoomboxBox.style.top)/_self.height)*(_self.ymax-_self.ymin);\n          var newxmax=((parseInt(_self.zoomboxBox.style.left)+parseInt(_self.zoomboxBox.style.width))/_self.width)*(_self.xmax-_self.xmin)+_self.xmin;\n          var newymin=_self.ymax-((parseInt(_self.zoomboxBox.style.top)+parseInt(_self.zoomboxBox.style.height))/_self.height)*(_self.ymax-_self.ymin);\n          _self.xmin=newxmin;\n          _self.xmax=newxmax;\n          _self.ymin=newymin;\n          _self.ymax=newymax;\n          _self.reDraw();\n          _self.onWindowChange([_self.xmin,_self.xmax,_self.ymin,_self.ymax]);\n        }\n        break;\n        case FOOPLOT_MODE_INTERSECTION:\n        _self.showIntersection(_self.dragInitX/_self.width*(_self.xmax-_self.xmin)+_self.xmin);\n        break;\n        case FOOPLOT_MODE_TRACE:\n        var initx=mx/_self.width*(_self.xmax-_self.xmin)+_self.xmin;\n        var order=Math.pow(10,2-Math.floor(Math.log(_self.xmax-_self.xmin)/Math.log(10)));\n        var initx=parseFloat(Math.floor(initx*order)/order);\n        var inity=(1-my/_self.height)*(_self.ymax-_self.ymin)+_self.ymin;\n        _self.showTrace(initx,inity);\n        break;\n      }\n    }\n  }\n\n  this.lastTouch=null;\n\n  this.container.ontouchmove=function(e) {\n    e.preventDefault();\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e.touches.length>=1) {\n      var _touch=e.touches[0];\n      _self.lastTouch=_touch;\n      this.mousemove(_touch);\n    } else {\n      _self.lastTouch=null;\n    }\n  }\n\n  this.container.ontouchstart=function(e) {\n    e.preventDefault();\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e.touches.length>=1) {\n      var _touch=e.touches[0];\n      _self.lastTouch=_touch;\n      this.mousedown(_touch);\n    } else {\n      _self.lastTouch=null;\n    }\n  }\n\n  this.container.ontouchend=function(e) {\n    e.preventDefault();\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e.touches.length==0) {\n      this.mouseup(_self.lastTouch);\n      _self.lastTouch=null;\n    }\n  }\n\n  this.onmousewheel=function(e) {\n    if(e === null) e = window.event;\n    for (i in FOOPLOT_INSTANCES) if(this===FOOPLOT_INSTANCES[i].container) var _self=FOOPLOT_INSTANCES[i];\n    if(e && e.preventDefault) e.preventDefault();\n    else e.returnValue=false;\n    if(e && (e.srcElement?e.srcElement:e.target).className=='fooplot-tool') return null;\n    var delta = 0;\n    if(e.wheelDelta) { /* IE/Opera. */\n      delta = e.wheelDelta/120;\n    } else if (e.detail) { /** Mozilla case. */\n      delta = -e.detail/3;\n    }\n    if(delta>0 && _self.zoomPendingFactor<=8) _self.zoom(1.25);\n    else if(delta<0 && _self.zoomPendingFactor>=0.125) _self.zoom(0.8);\n    else if(delta) _self.zoom(1);\n  }\n\n  this.container.onmousewheel=this.onmousewheel;\n\n  if(this.container.addEventListener) {\n    this.container.addEventListener('DOMMouseScroll',this.onmousewheel,false);\n  }\n\n  this.drawPoints=function(points) {\n    if(points.length) {\n      for(i in points) {\n        if(points[i].length==2) {\n          px=(points[i][0]-this.xmin)/(this.xmax-this.xmin)*this.width;\n          py=(this.ymax-points[i][1])/(this.ymax-this.ymin)*this.height;\n          if(!isNaN(px) && !isNaN(py) && 0<=px && px<=this.width && 0<=py && py<=this.height) {\n            this.context.fillRect(px-2,py-2,5,5);\n          }\n        }\n      }\n    }\n  }\n\n  this.drawFunction=function(jeq) {\n    var px,py,y,thisIsNaN=false,lastOnScreen,lastIsNaN=false,thisOnScreen,lastpx,lastpy,lasty,lastychange,isRedoLoop=false;\n    this.context.beginPath();\n    var started=false;\n    var pxstep=FOOPLOT_MSIE?1:0.25;\n    this.context.moveTo(-10,this.height/2);\n    for(px=0;px<this.width;px+=pxstep) {\n      this.vars.x=(px/this.width)*(this.xmax-this.xmin)+this.xmin;\n      y=jeq(this.vars);\n      if(isNaN(y)) {\n        if(!lastIsNaN) {\n          if(lastychange>0 && lasty>0) this.context.lineTo(lastpx,0);\n          else if(lastychange<0 && lasty<0) this.context.lineTo(lastpx,this.height);\n        }\n        thisOnScreen=false;\n        thisIsNaN=true;\n      } else {\n        py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n        thisOnScreen=py>=0 && py<=this.height;\n        if(py>this.height+100) py=this.height+100;\n        if(py<-100) py=-100;\n        thisIsNaN=false;\n      }\n      if(pxstep>.001 && thisOnScreen && !lastOnScreen) {\n        px-=pxstep;\n        pxstep/=10;\n      } else {\n        if(!(lastIsNaN || thisIsNaN) && (lastOnScreen || thisOnScreen)) {\n          this.context.lineTo(px,py);\n        } else {\n          if(!lastIsNaN && !thisIsNaN && lasty*y<0 && lasty*y>Math.min(-10,this.ymin-this.ymax)) {\n            this.context.lineTo(px,py);\n          } else {\n            this.context.moveTo(px,py);\n          }\n        }\n        if(thisOnScreen) pxstep=pxstep/Math.abs(lastpy-py);\n        else pxstep=1;\n        if(pxstep>2) pxstep=2;\n        else if(pxstep<0.001) pxstep=0.001;\n        else if(isNaN(pxstep)) pxstep=1;\n        lastpx=px;\n        lastpy=py;\n        lasty=y;\n        lastOnScreen=thisOnScreen;\n        lastIsNaN=thisIsNaN;\n      }\n    }\n    this.context.stroke();\n  }\n\n  this.drawPolar=function(jeq,thetamin,thetamax,thetastep) {\n    var px,py,x,y,r,lastOnScreen,thisOnScreen;\n    this.context.beginPath();\n    var points='';\n    var started=false;\n    for(this.vars.theta=thetamin;this.vars.theta<=thetamax;this.vars.theta+=thetastep) {\n      r=jeq(this.vars);\n      x=r*Math.cos(this.vars.theta);\n      y=r*Math.sin(this.vars.theta);\n      if(isNaN(y)||isNaN(x)) \n        thisOnScreen=false;\n      else {\n        px=(x-this.xmin)/(this.xmax-this.xmin)*this.width;\n        py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n        if(!started) { started=true;this.context.moveTo(px,py); }\n        thisOnScreen=(px>0 && px<this.width && py>0 && py<this.height);\n        if(lastOnScreen || thisOnScreen) {\n          this.context.lineTo(px,py);\n        } else {\n          this.context.moveTo(px,py);\n        }\n      }\n      lastOnScreen=thisOnScreen;\n    }\n    this.context.stroke();\n  }\n\n  this.drawParametric=function(jeqx,jeqy,smin,smax,sstep) {\n    var px,py,x,y,lastOnScreen,thisOnScreen;\n    var started=false;\n    this.context.beginPath();\n    for(this.vars.s=smin;this.vars.s<=smax;this.vars.s+=sstep) {\n      x=jeqx(this.vars);\n      y=jeqy(this.vars);\n      if(isNaN(y)||isNaN(x))\n        thisOnScreen=false;\n      else {\n        px=(x-this.xmin)/(this.xmax-this.xmin)*this.width;\n        py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n        if(!started) { started=true; this.context.moveTo(px,py); }\n        thisOnScreen=(px>0 && px<this.width && py>0 && py<this.height);\n        if(lastOnScreen || thisOnScreen) {\n          this.context.lineTo(px,py);\n        } else {\n          this.context.moveTo(px,py);\n        }\n      }\n      lastOnScreen=thisOnScreen;\n    }\n    this.context.stroke();\n  }\n\n  this.findIntersection=function(jeq0,jeq1,initx) {\n    var xpd,y0,y1,y,ypd,d=.0000000001;\n    var i=0;\n    if(jeq0===null) return 0;\n    if(jeq1===null) { jeq1=function() { return 0; } }\n    this.vars.x=initx;\n    y0=jeq0(this.vars);\n    y1=jeq1(this.vars);\n    y=y0-y1;\n    while(i<100) {\n      i++;\n      y0=jeq0(this.vars);\n      y1=jeq1(this.vars);\n      y=y0-y1;\n      this.vars.x+=d;\n      y0=jeq0(this.vars);\n      y1=jeq1(this.vars);\n      ypd=y0-y1;\n      if(y-ypd!=0) {\n        this.vars.x+=y*d/(y-ypd);\n      }\n    }\n    y0=jeq0(this.vars);\n    y1=jeq1(this.vars);\n    y=y0-y1;\n    if(isNaN(this.vars.x)) return null;\n    if(Math.abs(y)>1e-9) return null;\n    else return parseFloat(this.vars.x.toFixed(9));\n  }\n\n  this.showTrace=function(initx,inity) {\n    var i,y,minDistance=1e10,besti=null,besty=null;\n    this.vars.x=initx;\n    for(i in this.plots) {\n      if(this.plots[i]['type']===FOOPLOT_TYPE_FUNCTION) {\n        y=this.plots[i].jeq(this.vars);\n        if(Math.abs(y-inity)<minDistance) { minDistance=Math.abs(y-inity);besti=i;besty=y; }\n      }\n    }\n    if(besti===null) return null;\n    px=(initx-this.xmin)/(this.xmax-this.xmin)*this.width;\n    py=(this.ymax-besty)/(this.ymax-this.ymin)*this.height;\n    this.tracePoint.style.visibility='';\n    this.tracePoint.style.left=(px-3)+'px';\n    this.tracePoint.style.top=(py-3)+'px';\n    this.traceDisplay.style.visibility='';\n    this.traceDisplay.style.left=px+'px';\n    this.traceDisplay.style.top=(py+8-(py>this.height/2?48:0))+'px';\n    this.traceDisplayText.nodeValue=('('+parseFloat(initx.toFixed(9))+','+parseFloat(besty.toFixed(9))+')');\n  }\n\n  this.showIntersection=function(initx) {\n    this.vars.x=initx;\n    var i,j,yi,yj,minDistance=1e10,bestPair=null;\n    this.plotstmp=this.plots.slice(0);\n    this.plotstmp.unshift({'type':FOOPLOT_TYPE_FUNCTION,'jeq':function() {return 0;}});\n    for(i in this.plotstmp) {\n      if(this.plotstmp[i]['type']===FOOPLOT_TYPE_FUNCTION) {\n        for(j in this.plotstmp) {\n          if(i!=j && this.plotstmp[j]['type']===FOOPLOT_TYPE_FUNCTION) {\n            yi=this.plotstmp[i].jeq(this.vars);\n            yj=this.plotstmp[j].jeq(this.vars);\n            if(Math.abs(yi-yj)<minDistance) { minDistance=Math.abs(yi-yj);bestPair=[i,j]; }\n          }\n        }\n      }\n    }\n    if(bestPair===null) return null;\n    xroot=this.findIntersection(this.plotstmp[bestPair[0]].jeq,this.plotstmp[bestPair[1]].jeq,initx);\n    y=this.plotstmp[bestPair[0]].jeq(this.vars);\n    y=parseFloat(y.toFixed(9));\n    px=(xroot-this.xmin)/(this.xmax-this.xmin)*this.width;\n    py=(this.ymax-y)/(this.ymax-this.ymin)*this.height;\n    if(xroot!=null) {\n      this.intersectionPoint.style.visibility='';\n      this.intersectionPoint.style.left=(px-3)+'px';\n      this.intersectionPoint.style.top=(py-3)+'px';\n      this.intersectionDisplay.style.visibility='';\n      this.intersectionDisplay.style.left=px+'px';\n      this.intersectionDisplay.style.top=(py+8-(py>this.height/2?48:0))+'px';\n      this.intersectionDisplayText.nodeValue=('('+xroot+','+y+')');\n    }\n  }\n\n  this.tryToMakeFraction=function(testnum) {\n    var numerator,denominator;\n    // check if it is a nice fraction\n    for(var denominator=1;denominator<16;denominator++) {\n      numerator=(testnum*denominator).toFixed(9);\n      if(numerator.indexOf('.000000000')!=-1) return parseFloat(numerator)+(denominator===1?'':'/'+denominator);\n    }\n    // return the decimal back if we fail to get a nice fraction\n    return parseFloat(testnum.toFixed(9)).toString();\n  }\n\n  // PRIVATE: EQUATION PARSNIP\n\n  this.parseEquationError='';\n\n  this.parseEquationHasElement=function(v,e) {for(var i=0;i<v.length;i++) if(v[i]===e) return true;return false;}\n\n  this.parseEquationFixPowers=function(v) {\n    if(v===null) { this.parseEquationError?null:this.parseEquationError=\"syntax error\"; return null; }\n    for(i=0;i<v.length;i++) {\n      if(this.parseEquationIsArray(v[i])) { v[i]=this.parseEquationFixPowers(v[i]); if(v[i]===null) { this.parseEquationError?null:this.parseEquationError=\"syntax error\"; return null; } }\n    }\n    for(var i=0;i<v.length;i++) {\n      if(v[i]==='^') {\n        if(v[i-1]===null||v[i+1]===null) { this.parseEquationError=\"^ requires two arguments, for example x^2 or (x+1)^(x+2).\"; return null; }\n        v.splice(i-1,3,new Array('Math.pow',new Array('(',v[i-1],',',v[i+1],')')));\n        i-=2;\n      }\n    }\n    return v;\n  }\n\n  this.parseEquationFixFunctions=function(v) {\n    if(v===null) {this.parseEquationError?null:this.parseEquationError=\"syntax error\"; return null;}\n    for(i=0;i<v.length;i++) {\n      if(this.parseEquationIsArray(v[i])) {\n        v[i]=this.parseEquationFixFunctions(v[i]);\n        if(v[i]===null) {this.parseEquationError?null:this.parseEquationError=\"syntax error\"; return null;}\n      }\n    }\n    for(var i=0;i<v.length;i++) {\n      if(!this.parseEquationIsArray(v[i])) {\n        if(FOOPLOT_MATH[v[i]]!=undefined) {\n          if(v[i+1]===null) {this.parseEquationEror=\"function \"+v[i]+ \" requires an argument.\"; return null;}\n          v[i]='FOOPLOT_MATH.'+v[i].toLowerCase();\n          v.splice(i,2,new Array('(',v[i],v[i+1],')'));\n          i--;\n        }\n      }\n    }\n    return v;\n  }\n\n  this.parseEquationIsArray=function(v) {if(v==null){return 0;}if(v.constructor.toString().indexOf(\"Array\")===-1)return false;return true;}\n\n  this.parseEquationJoinArray=function(v) {var t=\"\";for(var i=0;i<v.length;i++){if(this.parseEquationIsArray(v[i])){ t+=this.parseEquationJoinArray(v[i]);}else{t+=v[i];}}return t;}\n\n  this.parseEquation=function(eq,vars) {\n    var jeq=null;\n    var tokens;\n    var e,i;\n    var pstart=-1,pend;\n    if(!vars) vars=this.vars;\n    jeq_error=\"\";\n    e=eq.replace(/ /g,\"\");\n    e=e.replace(/([0-9])([a-df-z]|[a-z][a-z]|\\()/ig,\"$1*$2\");\n    e=e.replace(/(\\))([0-9a-df-z]|[a-z][a-z]|\\()/ig,\"$1*$2\");\n    e=e.replace(/([a-z0-9\\.])([^a-z0-9\\.])/ig,\"$1 $2\");\n    e=e.replace(/([^a-z0-9\\.])([a-z0-9\\.])/ig,\"$1 $2\");\n    e=e.replace(/(\\-|\\)|\\()/g,\" $1 \");\n    tokens=e.split(/ +/);\n    for(i=0;i<tokens.length;i++) {\n      tokens[i]=tokens[i].replace(/ /g,\"\");\n      tokens[i]=tokens[i].replace(/_/g,\".\");\n      if(tokens[i]==='') { tokens.splice(i,1);i--; }\n      else if(tokens[i].match(/^[a-z][a-z0-9]*$/i) && vars[tokens[i]]!=undefined) { tokens[i]='vars.'+tokens[i]; }\n      else if(tokens[i].length>0 && tokens[i].match(/^[a-z][a-z0-9]*$/i) && FOOPLOT_MATH[tokens[i]]===undefined) { this.parseEquationError=\"invalid variable or function: \"+tokens[i];return null; }\n    }\n    while(this.parseEquationHasElement(tokens,'(')||this.parseEquationHasElement(tokens,')')) {\n      pstart=-1;\n      for(i=0;i<tokens.length;i++) {\n        if(tokens[i]==='(') pstart=i;\n        if(tokens[i]===')'&&pstart==-1) { this.parseEquationError=\"unmatched right parenthesis )\";return null; }\n        if(tokens[i]===')'&&pstart!=-1) {\n          tokens.splice(pstart,i-pstart+1,tokens.slice(pstart,i+1));\n          i=-1;\n          pstart=-1;\n        }\n      }\n      if(pstart!=-1) { this.parseEquationError=\"unmatched left parenthesis (\";return null; }\n    }\n    tokens=this.parseEquationFixFunctions(tokens);\n    if(tokens===null) { return null; }\n    tokens=this.parseEquationFixPowers(tokens);\n    if(tokens===null) { return null; }\n    eval('jeq=function(vars) { return '+this.parseEquationJoinArray(tokens)+'; }');\n    return jeq;\n  }\n\n  this.parseConst=function(eq) {\n    var consts={'pi':this.vars.pi,'e':this.vars.e};\n    var f=this.parseEquation(eq,consts);\n    if(f)\n      return parseFloat(f(consts));\n    else {\n      alert(this.parseEquationError);\n      return 0;\n    }\n  }\n\n  // PUBLIC\n\n  this.reDraw=function() {\n    this.hideIntersection();\n    this.hideTrace();\n    this.clear();\n    if(this.showGrid) {\n      this.context.strokeStyle=this.gridColor;\n      this.context.fillStyle=this.gridColor;\n      this.drawGrid();\n    }\n    if(this.showAxes) {\n      this.context.strokeStyle=this.axesColor;\n      this.context.fillStyle=this.axesColor;\n      this.drawAxes();\n    }\n    if(this.showLabels) {\n      this.context.fillStyle=this.labelsColor;\n      this.drawLabels();\n    }\n    for(var i in this.plots) {\n      this.context.strokeStyle='#000000';\n      switch(this.plots[i].type) {\n        case FOOPLOT_TYPE_FUNCTION:\n          this.context.strokeStyle=this.plots[i].options.color;\n          this.drawFunction(this.plots[i].jeq);\n          break;\n        case FOOPLOT_TYPE_POLAR:\n          this.context.strokeStyle=this.plots[i].options.color;\n          this.drawPolar(this.plots[i].jeq,this.plots[i].options.thetamin,this.plots[i].options.thetamax,this.plots[i].options.thetastep);\n          break;\n        case FOOPLOT_TYPE_PARAMETRIC:\n          this.context.strokeStyle=this.plots[i].options.color;\n          this.drawParametric(this.plots[i].jeqx,this.plots[i].jeqy,this.plots[i].options.smin,this.plots[i].options.smax,this.plots[i].options.sstep);\n          break;\n        case FOOPLOT_TYPE_POINTS:\n          this.context.fillStyle=this.plots[i].options.color;\n          this.drawPoints(this.plots[i].eq);\n          break;\n      }\n    }\n    if(FOOPLOT_MSIE) {\n      // hack for MSIE + excanvas which sometimes sporadically does not display the last-drawn path\n      // so we draw a dummy path\n      this.context.beginPath();\n      this.context.moveTo(0,-1);\n      this.context.lineTo(-1,-1);\n      this.context.stroke();\n    }\n  }\n\n  this.addPlot=function(eq,type,options) {\n    if(!type)    type=FOOPLOT_TYPE_FUNCTION;\n    if(!options) options={};\n    if(!options.color) options.color='#000000';\n    if(!options.width) options.width=1;\n    switch(type) {\n      case FOOPLOT_TYPE_FUNCTION:\n        var jeq=this.parseEquation(eq);\n        if(!jeq) {alert(this.parseEquationError);return null;}\n        this.plots.push({'id':this.plotlastid++,'type':type,'eq':eq,'jeq':jeq,'options':options});\n        break;\n      case FOOPLOT_TYPE_POLAR:\n        var jeq=this.parseEquation(eq);\n        if(!jeq) {alert(this.parseEquationError);return null;}\n        options['thetamin']=options['thetamin']?this.parseConst(options['thetamin']):0;\n        options['thetamax']=options['thetamax']?this.parseConst(options['thetamax']):2*this.vars.pi;\n        options['thetastep']=options['thetastep']?this.parseConst(options['thetastep']):0.01;\n        if(options['thetastep']<=0) options['thetastep']=0.01;\n        this.plots.push({'id':this.plotlastid++,'type':type,'eq':eq,'jeq':jeq,'options':options});\n      break;\n      case FOOPLOT_TYPE_PARAMETRIC:\n        var jeqx=this.parseEquation(eq[0]);\n        if(!jeqx) {alert(this.parseEquationError);return null;}\n        var jeqy=this.parseEquation(eq[1]);\n        if(!jeqy) {alert(this.parseEquationError);return null;}\n        options['smin']=options['smin']?this.parseConst(options['smin']):0;\n        options['smax']=options['smax']?this.parseConst(options['smax']):10;\n        options['sstep']=options['sstep']?this.parseConst(options['sstep']):0.01;\n        this.plots.push({'id':this.plotlastid++,'type':type,'eq':eq,'jeqx':jeqx,'jeqy':jeqy,'options':options});\n      break;\n      case FOOPLOT_TYPE_POINTS:\n        if(eq.length===null) return null;\n        this.plots.push({'id':this.plotlastid++,'type':type,'eq':eq,'options':options});\n      break;\n      default:\n      alert(\"Error: invalid plot type\");\n    }\n    return this.plots.size;\n  }\n\n  this.deletePlot=function(plotid) {\n    // not yet implemented\n  }\n\n  this.deleteAllPlots=function() {\n    this.plots=[];\n  }\n\n  this.getGrid=function() {\n    return [this.xgrid,this.ygrid];\n  }\n\n  this.setGrid=function(g) {\n    g[0]=g[0].replace(' ','');\n    if(g[0]) {\n      g[0]=this.parseConst(g[0]); if(g[0]<=0) g[0]=1;\n      this.xgrid=g[0];\n      if((720*g[0]/this.vars.pi).toFixed(6).match(/0000$/)!==null) {\n        this.xgridunits=FOOPLOT_UNITS_PI;\n      } else if((720*g[0]/this.vars.e).toFixed(6).match(/0000$/)!==null) {\n        this.xgridunits=FOOPLOT_UNITS_E;\n      } else {\n        this.xgridunits=null;\n      }\n    } else {\n      this.xgrid=null;\n      this.xgridunits=null;\n    }\n    g[1]=g[1].replace(' ','');\n    if(g[1]) {\n      g[1]=this.parseConst(g[1]); if(g[1]<=0) g[1]=1;\n      this.ygrid=g[1];\n      if((720*g[1]/this.vars.pi).toFixed(6).match(/0000$/)!==null) {\n        this.ygridunits=FOOPLOT_UNITS_PI;\n      } else if((720*g[1]/this.vars.e).toFixed(6).match(/0000$/)!==null) {\n        this.ygridunits=FOOPLOT_UNITS_E;\n      } else {\n        this.ygridunits=null;\n      }\n    } else {\n      this.ygrid=null;\n      this.ygridunits=null;\n    }\n  }\n\n  this.getWindow=function() {\n    return [this.xmin,this.xmax,this.ymin,this.ymax];\n  }\n\n  this.setWindow=function(w) {\n    w[0]=this.parseConst(w[0]);\n    w[1]=this.parseConst(w[1]);\n    w[2]=this.parseConst(w[2]);\n    w[3]=this.parseConst(w[3]);\n    if(w[1]>w[0] && w[3]>w[2]) {\n      this.xmin=w[0];\n      this.xmax=w[1];\n      this.ymin=w[2];\n      this.ymax=w[3];\n    } else {\n      // throw error\n    }\n  }\n\n  this.setBackgroundColor=function(color) {\n    this.backgroundColor=color;\n    this.container.style.background=color;\n    this.subcontainer.style.background=color;\n  }\n\n  this.setLabelsColor=function(color) {\n    this.labelsColor=color;\n  }\n\n  this.setAxesColor=function(color) {\n    this.axesColor=color;\n  }\n\n  this.setGridColor=function(color) {\n    this.gridColor=color;\n  }\n\n  this.setShowAxes=function(v) {\n    this.showAxes=v;\n  }\n\n  this.setShowTicks=function(v) {\n    this.showTicks=v;\n  }\n\n  this.setShowLabels=function(v) {\n    this.showLabels=v;\n  }\n\n  this.setShowGrid=function(v) {\n    this.showGrid=v;\n  }\n\n  this.getSVG=function() {\n    this.context=this.recorder;\n    this.reDraw();\n    this.context=this.canvas.getContext('2d');\n    return this.recorder.getSVG();\n  }\n\n  // EVENTS (user-settable functions)\n  this.onWindowChange=function(w) {};\n}\n\n// interface \"constants\"\n\nvar FOOPLOT_TYPE_FUNCTION=0;\nvar FOOPLOT_TYPE_POLAR=1;\nvar FOOPLOT_TYPE_PARAMETRIC=2;\nvar FOOPLOT_TYPE_POINTS=3;\n\nvar FOOPLOT_MODE_MOVE=1;\nvar FOOPLOT_MODE_ZOOMBOX=2;\nvar FOOPLOT_MODE_INTERSECTION=3;\nvar FOOPLOT_MODE_TRACE=4;\n\nvar FOOPLOT_UNITS_PI=1;\nvar FOOPLOT_UNITS_E=2;\n\n// keeps track of all instances, mainly for being able to access the class in event handlers\n\nvar FOOPLOT_INSTANCES=[];\n\n// extended math functions\n\nFOOPLOT_MATH={};\nFOOPLOT_MATH.sin=Math.sin;\nFOOPLOT_MATH.cos=Math.cos;\nFOOPLOT_MATH.tan=Math.tan;\nFOOPLOT_MATH.asin=Math.asin;\nFOOPLOT_MATH.acos=Math.acos;\nFOOPLOT_MATH.atan=Math.atan;\nFOOPLOT_MATH.abs=Math.abs;\nFOOPLOT_MATH.floor=Math.floor;\nFOOPLOT_MATH.ceil=Math.ceil;\nFOOPLOT_MATH.exp=Math.exp;\nFOOPLOT_MATH.sqrt=Math.sqrt;\nFOOPLOT_MATH.max=Math.max;\nFOOPLOT_MATH.min=Math.min;\nFOOPLOT_MATH.sec=function(x) { return 1/Math.cos(x); }\nFOOPLOT_MATH.csc=function(x) { return 1/Math.sin(x); }\nFOOPLOT_MATH.cot=function(x) { return 1/Math.tan(x); }\nFOOPLOT_MATH.asec=function(x) { return Math.acos(1/x); }\nFOOPLOT_MATH.acsc=function(x) { return Math.asin(1/x); }\nFOOPLOT_MATH.acot=function(x) { return Math.atan(1/x); }\nFOOPLOT_MATH.ln=function(x) { return Math.log(x); }\nFOOPLOT_MATH.log=function(x) { return Math.log(x)/Math.log(10); }\nFOOPLOT_MATH.sinh=function(x) { return (Math.exp(x)-Math.exp(-x))/2; }\nFOOPLOT_MATH.cosh=function(x) { return (Math.exp(x)+Math.exp(-x))/2; }\nFOOPLOT_MATH.tanh=function(x) { return (Math.exp(x)-Math.exp(-x))/(Math.exp(x)+Math.exp(-x)); }\nFOOPLOT_MATH.asinh=function(x) { return Math.log(x+Math.sqrt(x*x+1)); }\nFOOPLOT_MATH.acosh=function(x) { return Math.log(x+Math.sqrt(x*x-1)); }\nFOOPLOT_MATH.atanh=function(x) { return 0.5*Math.log((1+x)/(1-x)); }\nFOOPLOT_MATH.sech=function(x) { return 2/(Math.exp(x)+Math.exp(-x)); }\nFOOPLOT_MATH.csch=function(x) { return 2/(Math.exp(x)-Math.exp(-x)); }\nFOOPLOT_MATH.coth=function(x) { return (Math.exp(x)+Math.exp(-x))/(Math.exp(x)-Math.exp(-x)); }\nFOOPLOT_MATH.asech=function(x) { return Math.log(1/x+Math.sqrt(1/x/x-1)); }\nFOOPLOT_MATH.acsch=function(x) { return Math.log(1/x+Math.sqrt(1/x/x+1)); }\nFOOPLOT_MATH.acoth=function(x) { return 0.5*Math.log((1+x)/(1-x)); }\nFOOPLOT_MATH.u=function(x) { return (x>=0); }\n\nvar FOOPLOT_MSIE=(navigator.userAgent.toLowerCase().indexOf('msie')!=-1);\n\nvar FOOPLOT_TRANSITIONS=function() {\n  var b = document.body||document.documentElement;\n  var s = b.style;\n  var p = 'transition';\n  if(typeof s[p] === 'string') {return true; }\n  v = ['Moz', 'Webkit', 'Khtml', 'O', 'ms'],\n  p = p.charAt(0).toUpperCase() + p.substr(1);\n  for(var i=0; i<v.length; i++) {\n    if(typeof s[v[i] + p] === 'string') { return true; }\n  }\n  return false;\n}();\n\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}